# 20240127TOYOTA AHC 至高のアルゴリズム解説会

## AHC015 thunderさん

- 株式会社グリッド: 配線などの最適化
- ハロウィンキャンディ
- 問題特性
  - 最初からわかっている情報: すべてのキャンディの種類と順序
  - 途中からわかる情報: キャンディの置かれる場所
  - 制御できる
    - 次のキャンディの置ける場所はおおまかに決めることができる
  - 1個当たりの連結成分が大きい方がよい
    - 目指す姿: １個の連結成分にする
    - どのキャンディも箱の端側に寄った方がよい
- ルールベース1
  - 次のキャンディを出現させたい方向と逆側に箱を傾ける
  - 3種類のキャンディにあわせて右左下に寄せるように傾ける
- ルールベース2(95位相当)
  - 今と次のキャンディの組み合わせて方向を決める
- モンテカルロ法(1位相当)
  - ルールベース2ms、制限時間2000msで、時間がもったいない => 探索アルゴリズムでより良い解を見つけたい
  - 以下の情報が必要
    - 全ターンのキャンディの種類
    - 全ターンのキャンディの位置(不定の情報を乱数で補う)
    - 制御する方向
  - プライアウト: 終了時のスコアを計算
  - 乱数なのでプライアウトを何回もやる
- 至高のアルゴリズム
  - 高速化
    - 同じ方向に傾ける場合は、1個だけスライドすればよい
    - ヒューリスティックだと定数倍でも効果がある
  - 目標盤面の選択
    - 3種類のキャンディの数によって、最終的な形が違うため、
- 質問
  - 至高のアルゴリズムで効いたのは？
    - 目標盤面の選択
  - 2位の解放は？
    - 2番目に多いキャンディを後ろにした
    - 決め打ちだったが、至高は目標盤面6種類で確認した
  - 至高のプライアウトにかける時間は？
    - 時間を決めずに900回決め打ちにした
    - 最初の30ターンは900回プライアウト、そのあとは500回(400回)
  - シード固定で平等にするのがよさそう。シード固定しないとよくなかった
  - ルールベースが優秀だったため、MTCSはあまりよくなかった
    - ルールベースなしで、ランダムだけだとMTCS使った方がよくなる

## AHC026 bowwowforeachさん

- 株式会社THIRD
- 箱を移動
- ソート+chokudaiサーチ
- 1つの山をソートする。ソートの中で他の山の箱もまきこめるならまきこめる
- 昇順にする。昇順のまま戻す(差が大きいと昇順にするとよくない場合がある)
- 降順と昇順を比較する
  - 昇順で差が大きいと、その差の数値の箱が巻き込めない
  - その時の状態ではわからず、やってみないとわからない
  - 昇順の候補をすべて探索する
- ソートする山の選び方(探索)
- 探索
  - 山の選択
  - 山を殻にする際にどこで切るか
- 貪欲
  - どの山に置くか
  - 山に戻す
- 探索したい
  - 処理時間2秒あるので、何かしら探索したい
  - コスト+ソート進捗を評価値にするとよさそう？
  - 重みづけが難しそう
  - ターンが固定ではない、短いターンがよいわけでもない
  - 同じコストならソート進捗が進んでいる方がよい
    - 同じターンならスコアが高い方がよい
    - 同じターンなら進捗進んでいる方がよい
- chokudaiサーチ
  - 次の状態を考える。コストが低い方から進捗率がよいものを選択して、次の状態を作るを繰り返す
  - 進捗100%のコストがでると、それより悪いコストは見なくてよい
- ソートしていない箱の並び順の評価値を算出する(good/bad/best)
- chokudaiサーチメモリ問題
  - IntervalHeapが優先度低いのを削除できてよさそう
- 質問
  - 遷移: どこで切るかとどこの山に置くかを見る

## Transit Warehouse terry_u16さん

- 株式会社ALGO ARTIS
- D×D倉庫にM個のコンテナが運び込まれ、できるだけ昇順に運び出す
- 運び込み: モンテカルロ法+貪欲プレイアウト
- 運び出し: 貪欲法+焼きなまし法
- 運び込み
  - プレイアウトの質が重要
  - IDの小さいコンテナはくに、大きいコンテナは遠くに置きたい
  - BFSで置きたい距離Dを決める
- 運び出し
  - 入口に到達可能なコンテナをDFSで列挙し、一番小さいコンテナを運び出す
  - コンテナに優先度をつける
- 解放のブラシュアップ
  - 高速化
    - モンテカルロ法はプレイアウト回数が命
    - ばらつきは、試行回数をNとして1/N^(1/2)に比例するはず
    - 入口から到達可能なコンテナの列挙: DFS(O(D^2)) => コンテナの周囲だけ差分更新する(O(logD))
    - その他高速化: 250回 => 1000回(2倍)
  - プレイアウトの効率化
    - Successive Halving
    - 一定時間ごとに解を配分に絞り込む
    - 機械学習のハイパーパラメータ最適化でよく用いられる
  - 貪欲の改善
    - 空きマスコスト
    - ターゲットID: 入口を開けるため、少し遠めに置く
    - 距離マップ: 入口の距離に下駄をはかせる
    - コストマップ: 中央のスペースにコストを重めにする
    - 評価関数のパラメータ250個あるため、チューニングが必要
      - 焼きなましでチューニングする
    - 貪欲を焼いただけで、貪欲で1位を超えた
- 質問
  - ハイパーパラメータ1000回、1つのパラメータをいじる
  - 過学習しないようにバリデーションで1000回する
  - ビームサーチがよさそうだが。。。
  - コストは同じか。障害物が少ないため誤差になるため、固定。障害物が多いと悪い

## トヨタ

- 自動車業界100年に一度の変革期
  - 電動、自動、コネクティッド、シェアリング
- ヒューリスティックの活躍領域: 生産、物流
- 
